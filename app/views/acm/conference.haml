%aside.right
  = image_tag 'link-state.png'
  %h2 Important Info
  %ul.aside-list
    %li
      %span.key Date:
      .value October 26th-27th 2013
      %span.key Time:
      .value 2:00PM-7:00PM
      %span.key Location:
      .value
        %a{:href => 'http://goo.gl/xsJQRd'} Agnar Pytte Science Center, Case Western
      %span.key Contact:
      .value
        %a{:href => 'mailto:agn31@case.edu'} Aaron Neyer
      %span.key Twitter:
      .value
        %a{:href => 'https://twitter.com/cwruacm'} @cwruacm 
      %span.key Hashtag:
      .value #linkstate
      %span.key Facebook Event:
      .value
        %a{:href => 'https://www.facebook.com/events/1394226600806839'} Link-State 2013
%h1 Link-State 2013
:markdown
  ACM at Case Western Reserve University is proud to present our *second annual*
  conference. This year it will be a two day conference, and we've got a lot of
  awesome speakers coming.

  This page is a living document, it will be updated with information over time, **important updates will be emailed to you if you have signed up**.

%ul.toc
  %li
    %a{:href => '#speakers'} Schedule 
  %li
    %a{:href => '#parking'} Parking
  %li
    %a{:href => '#parking'} Meals
  %li
    %a{:href => '#register'} Register

:javascript
  var youTubeEmbedLink = function(id) {
    return 'http://www.youtube.com/embed/' + id;
  }
  var hideAllMediaContainers = function() {
    $('.media-container').hide();
  };
  var showMediaContainer = function(speakers_last_name) {
    hideAllMediaContainers();
    $container = $('#' + speakers_last_name);
    var initialYouTubeId = $container.find('.playVideo').first().data('video-id');
    var scribdId = $container.find('.scribd_iframe_embed').data('scribd-id');
    $container.find('.player').attr('src', youTubeEmbedLink(initialYouTubeId));
    $container.find('.scribd_iframe_embed').attr('src', 'http://www.scribd.com/embeds/' + scribdId + '/content?start_page=1&view_mode=slideshow&access_key=key-1srs9stk1x1wvj41y0bh');
    $container.show();
    $('body,html').animate({
      scrollTop: $container.position().top
    }, 1500)
  };
  var playVideoHandler = function(ev) {
    $container = $(ev.target).parents('.media-container');
    if ($player = $container.find('.player')) {
      $player.attr('src', youTubeEmbedLink($(ev.target).data('video-id')));
    }
  };
  $(function() {
    $('.playVideo').each(function(i) {
      $(this).on('click', playVideoHandler);
    });

    if (window.location.hash.indexOf("#Talk-") == 0) {
      showMediaContainer(window.location.hash.split('-')[1]);
    }
  });
-@speakers.each do |s|
  -last_name = s['name'].split.last
  .media-container{ :id => last_name }
    %h2 Presentation Viewer &mdash; #{s['name']}
    .video
      -if s['youtube']
        %iframe.player{ :width => '420', :height => '315', :src => '', :frameborder => 0, :allowfullscreen => '' }
        %ul
          -s['youtube'].sort_by{ |x| x['order'] }.each do |yt|
            %li{ :id => "#{last_name}-#{yt['order']}" }
              %a.playVideo{ :href => "#Talk-#{last_name}", :'data-video-id' => yt['youtube_id'] } Part #{yt['order']}
      -else
        .none
          No Video Available
    .slides
      -if s['scribd_id']
        %iframe.scribd_iframe_embed{ :'data-scribd-id' => s['scribd_id'], 'data-aspect-ratio' => '1.29936305732484', 'data-auto-height' => 'false', :frameborder => '0', :height => '315', :scrolling => 'no', :src => "", :width => '420' }
      -else
        .none
          No Slides Available
%h2 Schedule (TBA)
-#
  %table#schedule{:border => 1}
    %thead
      %th Time
      %th Clapp 108
      %th Millis Schmidt Auditorium
    %tr
      %td 2:00pm
      %td{:colspan => 3} Check-in w/ food
    %tr
      %td 2:30pm
      %td
        %a{:href => '#Google-desc'} TBA (Google)
      %td
        %a{:href => '#Microsoft-desc'} TBA (Microsoft)
      %td
    %tr
      %td 11:00am
      %td
        %a{:href => '#Stack-desc'} Brian Stack (Yelp)
      %td
        %a{:href => '#Daw-desc'} Tim (Sociogram)
      %td
    %tr
      %td 12:15pm
      %td{:colspan => 3} Lunch
    %tr
      %td 1:30pm
      %td
      %td
      %td Lightning Talks
    %tr
      %td 2:25pm
      %td
        %a{:href => '#Barendt-desc'} Nick Barendt (LeanDog)
      %td
        %a{:href => '#Zhang-desc'} Shijie Zhang (Google)
      %td
    %tr
      %td 3:30pm
      %td
      %td
        %td
          %a{:href => '#Ramey-desc'} Chet Ramey (Keynote, CWRU)
    %tr
      %td 5:00pm
      %td
      %td
      %td Closing Remarks
    %tr
      %td 5:10pm
      %td{:colspan => 3} Dinner
    %tr
      %td 6:30pm
      %td{:colspan => 3} Hackathon and Social Events

    #speakers
      #keynote.hilite
        %h2
          Keynote: #{@keynote['title']}
          %br
          with #{@keynote['name']} (#{@keynote['affiliation']})
          %span.twitter= @keynote['twitter']
        :markdown
          #{@keynote['bio']}

      %h2 Speakers
      %ul.speaker-list
        - @speakers.each do |s|
          -last_name = s['name'].split.last
          %li{ :id => "#{last_name}-desc" }
            %h3= s['name']
            -if s['twitter']
              %span.twitter= s['twitter']
            .affiliation= s['affiliation']
            .title= s['title']
            %a{ :href => "#Talk-#{last_name}", :onclick => "javascript:showMediaContainer(\"#{last_name}\");" } View Presentation
            .bio
              :markdown
                #{s['bio']}
            -if s['website']
              %a{ :href => s['website'] }= s['website']

#parking
  %h2 Parking
  :markdown
    Visitor parking is available in <a href="http://goo.gl/maps/qDdWW">lots 29 and 53</a>.  Standard parking charges an hourly rate for parking in these lots.  More information on parking can be found on <a href="http://www.case.edu/accessservices/parking_rates.html">standard parking's website</a>(scroll to the bottom for hourly rates).

#meals
  %h2 Meals
  :markdown
    There will be catered lunch and dinner on Saturday, and lunch on Sunday.
    The signup form has a field for dietary restrictions!

#register
  %h2 Register
  %iframe{:width => '100%', :height => '300', :frameborder => '0', :src => 'http://www.eventbrite.com/tickets-external?eid=7553750471&ref=etckt&v=2', :target => 'HTML' }
    %img{ :border => '0',  :src =>'http://www.eventbrite.com/custombutton?eid=4653432542', :alt =>'Register for Eventbrite API - Office Hours on Eventbrite'}

:javascript
  $(document).ready( function() {
    $('#schedule td').each( function(index, el) {
      var el = $(el);
      el.hover(
        function() {
          //handle in
        },
        function() {
          //handle out
        }
      );
    });
  });
